@inject HttpClient Http
<!-- ======= Contact Section ======= -->
<section id="contact" class="contact" style="background: rgb(34,195,158);
background: linear-gradient(225deg, rgba(34,195,158,1) 0%, rgba(87,102,130,1) 100%);border-radius:5px">
    <div class="container">
        <div class="row">


            <div class="col-lg-12" data-aos="fade-up" data-aos-delay="100">

                
                    <form class="php-email-form mt-4">

                        <div class="form-group mt-3">
                            <h3 style="color:beige">@cinta.Nombre</h3>
                        </div>
                    @foreach(var i in Niveles)
                    {
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <input id="" placeholder="@i.Nominal" class="form-control" />
                            </div>
                            <div class="col-md-6 form-group mt-3 mt-md-0">
                                <input id="" placeholder="@i.Correccion" class="form-control" />
                            </div>
                        </div>
                    }
                    <EditForm Model="nivel">
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <input type="number" id="" @bind-value=nivel.Nominal placeholder="Nominal" class="form-control" />
                            </div>
                            <div class="col-md-6 form-group mt-3 mt-md-0">
                                <input type="number" id="" @bind-value=nivel.Correccion placeholder="Correccion" class="form-control" />
                            </div>
                        </div>
                    </EditForm>
                    
                        <div class="my-3">
                            <div class="sent-message"><b style="color:beige">Recuerde configurar los rangos de la cinta</b> </div>
                        </div>                   
                    </form>
                <div class="text-center"><button class="btn btn-primary" @onclick=GuardarMiNivel>Guardar Nivel</button></div>
           <br />
            </div>
        </div>

    </div>
</section><!-- End Contact Section -->
@foreach(var i in Niveles)
{
    <p>@i.Id</p>
}
@code {
    [Parameter]
    public Cinta? cinta { get; set; }
    NivelesDeLaCinta nivel = new NivelesDeLaCinta();
    public static List<NivelesDeLaCinta> Niveles = new List<NivelesDeLaCinta>();
    //Lita de Tipo de fluido
    protected override async Task OnInitializedAsync()
    {
        var niveles = await Http.GetFromJsonAsync<List<NivelesDeLaCinta>>("api/NivelesDeLaCinta");
        Niveles = niveles.Where(x => x.CintaId == cinta.Id).ToList();
    }
    public static List<string> Descripciones = new List<string>
        {
            {"Crudo"},{"Refinado"}
    };

    async Task GuardarMiNivel()
    {
        nivel.Cita = cinta;
        nivel.CintaId = cinta.Id;         
        var respuesta = await Http.PostAsJsonAsync("api/NivelesDeLaCinta", nivel);
        var niveles = await Http.GetFromJsonAsync<List<NivelesDeLaCinta>>("api/NivelesDeLaCinta");
        Niveles = niveles.Where(x => x.CintaId == cinta.Id).ToList();
    }
    
}
